"""
상수 및 설정 정의
================

지표 목록, 등급 기준, 방향성 등 불변 설정값을 정의합니다.
기존 backend/report/config.py를 서버용으로 재구성했습니다.
"""
from typing import Dict, List

# =============================================================================
# 예측 타겟 (13개 재무지표)
# =============================================================================
TARGET_METRICS: Dict[str, List[str]] = {
    '수익성': ['ROA', 'ROE', '매출액영업이익률'],
    '안정성': ['부채비율', '자기자본비율', '자본잠식률'],
    '차입금': ['단기차입금비율'],
    '유동성': ['유동비율', '당좌비율', '유동부채비율'],
    '현금흐름': ['CFO_자산비율', 'CFO_매출액비율', 'CFO증감률'],
}

# 전체 타겟 리스트 (13개)
ALL_TARGETS: List[str] = [m for metrics in TARGET_METRICS.values() for m in metrics]

# 메타 컬럼 (피처로 사용하지 않음)
META_COLS: List[str] = ['기업코드', '기업명', '시장구분', '업종코드', '업종명', '년도', '분기']


# =============================================================================
# 등급 기준 (백분위 기반)
# =============================================================================
GRADE_THRESHOLDS: Dict[str, int] = {
    'A+': 10,   # 상위 10%
    'A': 25,    # 상위 25%
    'B+': 40,   # 상위 40%
    'B': 60,    # 상위 60%
    'C': 80,    # 상위 80%
    'F': 100,   # 하위 20%
}

GRADE_SCORES: Dict[str, int] = {
    'A+': 6,
    'A': 5,
    'B+': 4,
    'B': 3,
    'C': 2,
    'F': 1,
}


# =============================================================================
# 지표별 방향성
# =============================================================================
# 'higher': 높을수록 좋음, 'lower': 낮을수록 좋음
METRIC_DIRECTION: Dict[str, str] = {
    # 수익성
    'ROA': 'higher',
    'ROE': 'higher',
    '매출액영업이익률': 'higher',
    # 안정성
    '부채비율': 'lower',
    '자기자본비율': 'higher',
    '자본잠식률': 'lower',
    # 차입금
    '단기차입금비율': 'lower',
    # 유동성
    '유동비율': 'higher',
    '당좌비율': 'higher',
    '유동부채비율': 'lower',
    # 현금흐름
    'CFO_자산비율': 'higher',
    'CFO_매출액비율': 'higher',
    'CFO증감률': 'higher',
}


# =============================================================================
# 모델 신뢰도 기준
# =============================================================================
MODEL_CONFIDENCE: Dict[str, float] = {
    'high': 0.7,
    'medium': 0.4,
    'low': 0.0,
}

# 각 지표별 모델 R² (학습 결과)
MODEL_R2: Dict[str, float] = {
    'ROA': 0.4034,
    'ROE': 0.3365,
    '매출액영업이익률': 0.6626,
    '부채비율': 0.8148,
    '자기자본비율': 0.9428,
    '자본잠식률': 0.9881,
    '단기차입금비율': 0.7897,
    '유동비율': 0.8687,
    '당좌비율': 0.8703,
    '유동부채비율': 0.7856,
    'CFO_자산비율': 0.2775,
    'CFO_매출액비율': 0.5164,
    'CFO증감률': 0.2973,
}


# =============================================================================
# 지표 설명
# =============================================================================
METRIC_DESCRIPTION: Dict[str, str] = {
    'ROA': '총자산이익률 - 자산 대비 순이익 비율',
    'ROE': '자기자본이익률 - 자기자본 대비 순이익 비율',
    '매출액영업이익률': '매출액 대비 영업이익 비율',
    '부채비율': '자기자본 대비 부채 비율',
    '자기자본비율': '총자산 대비 자기자본 비율',
    '자본잠식률': '자본금 대비 결손금 비율',
    '단기차입금비율': '총자산 대비 단기차입금 비율',
    '유동비율': '유동부채 대비 유동자산 비율',
    '당좌비율': '유동부채 대비 당좌자산 비율',
    '유동부채비율': '총부채 대비 유동부채 비율',
    'CFO_자산비율': '총자산 대비 영업현금흐름 비율',
    'CFO_매출액비율': '매출액 대비 영업현금흐름 비율',
    'CFO증감률': '영업현금흐름 전분기 대비 증감률',
}

METRIC_FORMAT: Dict[str, str] = {metric: '{:.2f}%' for metric in ALL_TARGETS}
